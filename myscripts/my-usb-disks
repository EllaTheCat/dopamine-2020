#!/bin/bash
#
# Spin down the USB drives attached to my desktop PC, their blue LEDs
# should stay dark. The 1 Tbyte drive Banana automatically spins down,
# 4 Tbyte drive Tabasco drive only spins down when requested.
#

configure ()
{
    sudo  /usr/sbin/hd-idle -i 0 -a sdc -i 1200 -a sdd -i 1200
}

dismount ()
{
    case "$1" in
        (sdc)
            sudo umount  /mnt/usb-Seagate_M3_Portable_BFF77E010D000086-0:0-part1
            ;;
        (sdd)
            sudo umount  /mnt/usb-Seagate_M3_Portable_NM14ATY5-0:0-part2
            ;;
        (all)
            sudo umount  /mnt/usb-Seagate_M3_Portable_BFF77E010D000086-0:0-part1
            sudo umount  /mnt/usb-Seagate_M3_Portable_NM14ATY5-0:0-part2
            ;;
    esac
}

spindown ()
{
    case "$1" in
        (sdc)
            sudo /usr/sbin/hd-idle -t sdc
            ;;
        (sdd)
            sudo /usr/sbin/hd-idle -t sdd
            ;;
        (all)
            sudo /usr/sbin/hd-idle -t sdc
            sudo /usr/sbin/hd-idle -t sdd
            ;;
    esac
}

#
# Start here.
#

# Do a "belt and braces" check for "safe" script arguments because
# "sudo" and "/etc/sudoers.d" are involved.
case "$1" in
    (configure)
        "$1"
        ;;
    (dismount|spindown)
        "$1" "$2"
        ;;
esac

#
# Done.
#
